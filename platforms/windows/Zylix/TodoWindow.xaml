<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="Zylix.TodoWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Zylix"
    Title="Zylix Todo">

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}" Padding="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0"
                   Text="todos"
                   FontSize="48"
                   FontWeight="Light"
                   Foreground="#B83F45"
                   HorizontalAlignment="Center"
                   Margin="0,0,0,20"/>

        <!-- Input Section -->
        <Grid Grid.Row="1" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Toggle All Button -->
            <Button Grid.Column="0"
                    x:Name="ToggleAllButton"
                    Content="⌄"
                    FontSize="24"
                    Width="50"
                    Height="50"
                    Click="ToggleAll_Click"
                    Background="Transparent"
                    BorderThickness="0"/>

            <!-- New Todo Input -->
            <TextBox Grid.Column="1"
                     x:Name="NewTodoInput"
                     Text="{x:Bind ViewModel.NewTodoText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                     PlaceholderText="What needs to be done?"
                     FontSize="18"
                     Padding="15"
                     Margin="10,0"
                     KeyDown="NewTodoInput_KeyDown"/>

            <!-- Add Button -->
            <Button Grid.Column="2"
                    x:Name="AddButton"
                    Content="Add"
                    FontSize="16"
                    Width="80"
                    Height="50"
                    Click="AddTodo_Click"
                    IsEnabled="{x:Bind ViewModel.CanAddTodo, Mode=OneWay}"/>
        </Grid>

        <!-- Filter Tabs -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    Margin="0,10,0,10"
                    Spacing="10">
            <Button x:Name="FilterAllButton"
                    Content="All"
                    Click="FilterAll_Click"
                    Width="100"/>
            <Button x:Name="FilterActiveButton"
                    Content="Active"
                    Click="FilterActive_Click"
                    Width="100"/>
            <Button x:Name="FilterCompletedButton"
                    Content="Completed"
                    Click="FilterCompleted_Click"
                    Width="100"/>
        </StackPanel>

        <!-- Todo List -->
        <ListView Grid.Row="3"
                  x:Name="TodoListView"
                  ItemsSource="{x:Bind ViewModel.FilteredItems, Mode=OneWay}"
                  SelectionMode="None"
                  Margin="0,10">
            <ListView.ItemTemplate>
                <DataTemplate x:DataType="local:TodoItem">
                    <Grid Padding="10" Background="Transparent">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Checkbox -->
                        <CheckBox Grid.Column="0"
                                  IsChecked="{x:Bind IsCompleted, Mode=TwoWay}"
                                  VerticalAlignment="Center"/>

                        <!-- Todo Text -->
                        <TextBlock Grid.Column="1"
                                   Text="{x:Bind Text}"
                                   FontSize="18"
                                   VerticalAlignment="Center"
                                   Margin="10,0"
                                   TextDecorations="{x:Bind IsCompleted, Mode=OneWay, Converter={StaticResource StrikethroughConverter}}"
                                   Opacity="{x:Bind IsCompleted, Mode=OneWay, Converter={StaticResource CompletedOpacityConverter}}"/>

                        <!-- Delete Button -->
                        <Button Grid.Column="2"
                                Content="✕"
                                Tag="{x:Bind}"
                                Click="DeleteTodo_Click"
                                Background="Transparent"
                                BorderThickness="0"
                                FontSize="16"
                                Foreground="#CC9A9A"
                                VerticalAlignment="Center"/>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Footer -->
        <Grid Grid.Row="4" Margin="0,10,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Items Left -->
            <TextBlock Grid.Column="0"
                       Text="{x:Bind ViewModel.ItemsLeftText, Mode=OneWay}"
                       FontSize="14"
                       VerticalAlignment="Center"
                       Opacity="0.7"/>

            <!-- Clear Completed -->
            <Button Grid.Column="1"
                    Content="Clear completed"
                    Click="ClearCompleted_Click"
                    Visibility="{x:Bind ViewModel.HasCompleted, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                    Background="Transparent"
                    BorderThickness="0"
                    FontSize="14"/>
        </Grid>

        <!-- Stats Panel -->
        <Border Grid.Row="5"
                Background="#F5F5F5"
                CornerRadius="4"
                Padding="15"
                Margin="0,10,0,0">
            <TextBlock Text="{x:Bind ViewModel.StatsText, Mode=OneWay}"
                       FontSize="12"
                       FontFamily="Consolas"
                       Opacity="0.7"
                       HorizontalAlignment="Center"/>
        </Border>
    </Grid>
</Window>
